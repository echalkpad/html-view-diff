This is back-end of html-view-diff